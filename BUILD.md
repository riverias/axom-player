# Инструкция по сборке и настройке автообновлений

## 1. Подготовка к сборке

### Установка зависимостей
```bash
npm install
```

### Генерация ключей для автообновлений
```bash
# Windows
powershell -ExecutionPolicy Bypass -File generate-keys.ps1

# Или вручную
cargo install tauri-cli
cargo tauri signer generate -w ~/.tauri/axom.key
```

## 2. Настройка GitHub

### Добавление секретов в GitHub Repository
1. Перейдите в Settings > Secrets and variables > Actions
2. Добавьте секреты:
   - `TAURI_PRIVATE_KEY` - содержимое файла `~/.tauri/axom.key`
   - `TAURI_KEY_PASSWORD` - пароль для ключа (если задавали)

### Обновление публичного ключа
1. Скопируйте публичный ключ из вывода команды генерации
2. Замените значение `pubkey` в `src-tauri/tauri.conf.json`

## 3. Сборка приложения

### Локальная сборка
```bash
npm run tauri build
```

### Релиз через GitHub
1. Создайте тег версии:
```bash
git tag v1.0.0
git push origin v1.0.0
```

2. GitHub Actions автоматически соберет и создаст релиз

## 4. Защита от декомпиляции

### Минификация и обфускация
- Код React автоматически минифицируется при сборке
- Rust код компилируется в нативный бинарник

### Дополнительная защита
- Используется strip для удаления отладочной информации
- Включена оптимизация компилятора Rust
- Удалены все комментарии и отладочные сообщения

## 5. Автообновления

### Как работает
1. При запуске приложение проверяет GitHub Releases
2. Если найдена новая версия, показывается диалог обновления
3. Пользователь может обновиться одним кликом

### Настройка URL обновлений
В `tauri.conf.json` указан endpoint:
```
https://github.com/xivu/axom/releases/latest/download/latest.json
```

Замените `xivu/axom` на ваш GitHub репозиторий.

## 6. Структура релиза

После сборки создаются файлы:
- `axom_1.0.0_x64_en-US.msi` - установщик для Windows
- `latest.json` - метаданные для автообновлений
- Подписанные файлы для безопасности

## 7. Публикация

1. Загрузите собранные файлы в GitHub Release
2. Пользователи получат уведомление об обновлении автоматически
3. Новые пользователи могут скачать установщик